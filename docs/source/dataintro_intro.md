# イントロダクション

中村文香（和歌山大学　経済学部）

最終更新日：2024年12月3日

# はじめに

この文書は、Excelを用いてデータ実証を行う方法をまとめたものです。和歌山大学経済学部の統計学入門を履修した学生を対象にしていますが、基礎的な統計学の知識があれば、履修していない方でも理解できる内容です。

分析には、ExcelやGoogle Sheetsなどの表計算ソフトを使うことを想定します。ですが、具体的な関数の話以外は、他の統計ソフトを使う際にも適用できるものです。まずは実際に手元のデータで何ができるかを知りたいという方への、分析のヒントにもなると思います。

「実際に起こりうるシチュエーションにおいて、どのようにデータを活用するか」を主眼に置いているため、厳密さより分かりやすさを優先した記述があります。ご了承ください。

## 学習内容について

具体的には、以下の内容を学習します。

- 記述統計と推測統計の違いを理解する
- 記述統計の基礎的な手法を身に着ける
    - 手元のデータを適切に加工し、表やグラフを作成する
    - 統計量（特に平均、分散と標準偏差、共分散と相関係数）を計算し、データの特徴を理解する
- 推測統計の基礎的な手法を身に着ける
    - 仮説検定の手順を身に着ける
    - 回帰分析を行う
    - 因果推論について知る

# Chapter 1：データの種類と構造について

まずは、データにはどのような種類のものがあるのか、正しいデータの構造とは何か、について学んでいきます。

データの種類によって適切な分析手法が異なるため、手元のデータがどのような特性を持つデータなのかを理解することは大切です。

また、**「綺麗なデータ」**と**「汚いデータ」**というものが存在します。自分自身でデータをとる際には「綺麗なデータ」の状態で管理することが大切ですし、時には、取得した「汚いデータ」を「綺麗なデータ」に加工することも必要になります。分析しやすい「綺麗なデータ」はどのような構造を取るべきかについて解説します。

## データの種類

データは、データのとり方とデータをとる対象によって、いくつかの種類に分けることができます。

### 個人情報か集計情報か

データが含む情報の性質により、データは2種類に分けられます。

- マイクロデータ（個票データ）
    - 個人の情報を集めたデータのことです。
    （例）クラス40人それぞれのテストの点数、東京都に住んでいる1000人それぞれの家計得、東京証券取引所に上場している企業それぞれの売上金額など
- マクロデータ（集計データ）
    - 個別の情報を集計したもので、特定のグループを対象にしたデータです。
    （例）複数のクラスの平均点、都道府県の平均所得など

### 時間の情報を含むか含まないか

- クロスセクション・データ
    - 1時点において複数の対象の情報を横断的に集めたデータのことです。
    （例）1回分の算数のテストの点数、2024年における世界各国の平均家計所得など
- 時系列データ
    - 1つの対象についての時間を通じた変化を記録したデータのことです。
    （例）日経平均株価、日本円の対ドル為替レートなど
- パネルデータ
    - 複数の対象の時間を通じた変化を記録したデータのことです。
    （例）40人の生徒の小1～小6までの算数のテストの点数など

それぞれの性質の組み合わせによって、「クロスセクションのマクロデータ」、「個票のパネルデータ」、「マクロの時系列データ」などが存在します。手元のデータは誰を（何を）対象に取られたものなのか、同じ対象について1回のみ取られたデータなのか、それとも同じ対象について複数回取られたデータなのかに注目して、適切に分類できるようになりましょう。

## データの構造

データには、分析しやすい正しい構造というものが存在します。取得したデータが正しい構造になっていないときには、分析前に正しい構造に加工する作業が必要になります。まずは、目指すべき構造を学びましょう。また、自分でデータを取る際には、正しい構造で管理するようにしましょう。

### 「汚いデータ」の例

「汚いデータ」とは、例えば以下のようなものです。

[https://www.notion.so](https://www.notion.so)

> 分析がしづらくなるポイント
> 
> - セルが結合されている
> - 1つの対象について、複数行のデータが存在する
> - 対象を一意に特定するための項目が足りていない
> - 表記が揺れている
>     - 特に、半角と全角が混同していると分析の支障になる
>     - 同じように見える記号でも、Unicode（文字コード）が異なれば別の文字として認識されてしまうので注意
> - データとしてほしい情報以外の情報が存在する（特定の文字やセルに装飾がされていたり、コメントが挿入されているなど）

こういったデータは、分析がしづらいだけでなく、思い通りに関数が働かない原因になります。取得したデータがこのような「汚いデータ」なら、まずは以下に示すような「綺麗なデータ」に直してから分析を始めましょう（ちなみに、この作業が1番時間がかかることが多いです）。

そもそも、自分で一からデータをとる際には、最初から「綺麗なデータ」になるように工夫が必要です。

### 汚いデータにならないようにするために

具体的には、以下のような方法でデータをとりましょう。

- Google FormsやMicrosoft Formsなどの、フォームを利用してデータをとる
    - 機密情報が含まれるなど、必要な場合には専門業者に委託する
- 表記が揺れそうな項目はプルダウンなどの選択式にする
- データは、Excel形式（`.xlsx`）ではなく、CSV形式（`.csv`）で保存する

ご覧いただいて分かる通り、**そもそもExcel入力でデータを取らないこと**が解決策です。まずは表記揺れが出ない形式でフォームを作成し、フォームで回答されたものをCSVファイルでダウンロードすることで、一発で「綺麗なデータ」を手に入れることができます。

なぜExcelではなくCSVで保存する必要があるのか、というと、**CSVだと余計な操作ができないから**です。例えば、シートを追加する、文字を装飾する、セルを装飾する、セルを結合する…。こういった操作はCSVでは保存できません（保存する際にアラートが出ると思います）。これらはすべてデータに余計な情報を付け加えてしまうことにつながるので、生のデータを保存しているファイルに行われるべき操作ではありません。

生のデータから表やグラフを作成したり、統計量を計算したりするなど、データを加工する際には、生のデータを複製しExcelファイルに変換した分析用ファイルで行うか、ブックリンクを作成するかしましょう。

以降、データは`.csv` 形式で保存されていると想定します。

### 正しいデータの構造

では、いよいよ「綺麗なデータ」を見ていきましょう。

[https://www.notion.so](https://www.notion.so)

<aside>
💡

チェックポイント

- 1番上の行に変数名が入っている
- 1番左の列はID変数
- 表記ゆれがない
    - 日本語は全角、英数字は半角に統一されている
- 変数名はアルファベットで定義されている
- データはできるだけ数字にする
</aside>

## ここで使用するデータについて

今後は一貫して、**「学祭の売り上げ向上プロジェクト」**においてデータ分析を活用していくという想定で話を進めていきます。